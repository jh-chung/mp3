---
title: "mp3_code"
author: "Jay-Ho Chung"
date: "4/9/2018"
output: html_document
---

```{r Packaages, message=FALSE, warning=FALSE}
library(sf)
library(macleish)
library(leaflet)
library(tidyverse)
```

```{r Identifying Quickly}
macleish_layers[["trails"]] # 15 trails, geometry: Linestring, projection is longlat
```

```{r}
trails <- macleish_layers[["trails"]] %>% 
  mutate(length = st_length(geometry)) %>% 
  group_by(name) %>% 
  summarize(total_length = sum(length))

leaflet() %>% 
  addTiles() %>% 
  addPolylines(data = trails, popup = ~name)
```

```{r, eval=FALSE}
url <- "http://download.massgis.digital.mass.gov/shapefiles/state/contours250k.zip"
local_file <- basename(url)
download.file(url, destfile = local_file)
unzip(local_file)
```

```{r}
boundary <- macleish_layers[["boundary"]]
contour <- st_read("CONTOURS250K_ARC.shp") %>%
  st_transform(4326)
contour
macleish_trail <- st_intersects(boundary, contour)
```

```{r}
contour %>%
  select(CONTOUR_FT) %>%
  plot()
```

```{r}
leaflet() %>% 
  addTiles() %>% 
  addPolygons(data = boundary)
# macleish_trail %>% 
#   plot()
```

```{r}
hiking_trails <- macleish_layers[["trails"]] %>%
  mutate(lengt = st_length(geometry)) %>% 
  group_by(name) %>% 
  mutate(t_length = sum(lengt))

hiking_trails

pal <- colorNumeric(
  palette = "viridis",
  domain = hiking_trails$t_length
)

leaflet(data = hiking_trails) %>%
  addTiles() %>%
  addPolylines(color = ~pal(t_length))
```
